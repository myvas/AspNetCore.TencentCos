function UploadFile(n,t,i,r,u){var e=new FormData,f;e.append("file",t,t.customName||t.name);f=new XMLHttpRequest;f.onreadystatechange=function(n){var t=n.target,u;t.readyState==XMLHttpRequest.DONE&&(t.status==200?(u=f.responseText,i(u)):r!=null&&r(f.status,f.statusText))};r!=null&&(f.onerror=function(n){r(500,n.message)});u!=null&&(f.upload.onprogress=function(n){u(n.loaded,n.total)});f.open("POST",n);f.send(e)}function IsDraggableSupported(){var n=document.createElement("div");return"draggable"in n||"ondragstart"in n&&"ondrop"in n}function IsPasteSupport(){return"onpaste"in document}function InitUploadZone(n){function h(){for(var t="",n=0;n<i.length;n++){var r=i[n],u=r.customName||r.name,f=s.getAttribute("data-urlformat"),e=f.replace("filenameplaceholder",u);t+="<div data-file-index='"+n+"' class='up-file'><div class='up-file-name'><a href='"+e+"' target='_blank'>"+u+"<\/a><\/div><div class='up-file-state'>Waiting<\/div><div class='clear'><\/div><div class='up-file-progress'><\/div><\/div>"}s.innerHTML=t}function f(){if(r++,i.length>r){var e=null,t=null,n=s.querySelector("[data-file-index='"+r+"']");n!=null&&(n.classList.add("up-file-current"),e=n.querySelector(".up-file-progress"),t=n.querySelector(".up-file-state"));UploadFile(u.action,i[r],function(){n!=null&&(n.classList.remove("up-file-current"),n.classList.add("up-file-done"),t.innerHTML="Done");f()},function(){n!=null&&(n.classList.remove("up-file-current"),n.classList.add("up-file-error"),t.innerHTML="Failed");f()},function(n,i){var r=100/i*n;e.style.width=r+"%";t.innerHTML=Math.floor(r)+"%"})}else o.removeAttribute("disabled"),u.reset()}var t,c,u,e,o,s,i=[],r=-1;t=document.getElementById(n);c=t.querySelector(".up-form");u=c.querySelector("form");e=u.querySelector("input[type='file']");e.addEventListener("change",function(){o.setAttribute("disabled","disabled");i=e.files;r=-1;h();f()});o=u.querySelector("button");o.addEventListener("click",function(n){e.click();n.preventDefault()});t.addEventListener("drag",function(n){n.preventDefault()});t.addEventListener("dragstart",function(n){n.preventDefault()});t.addEventListener("dragend",function(n){n.preventDefault()});t.addEventListener("dragover",function(n){n.preventDefault()});t.addEventListener("dragenter",function(n){n.preventDefault()});t.addEventListener("dragleave",function(n){n.preventDefault()});t.addEventListener("drop",function(n){i=n.dataTransfer.files;r=-1;h();f();n.preventDefault()});s=t.querySelector(".up-status");IsDraggableSupported()&&document.body.classList.add("up-draggable");IsPasteSupport()&&(document.addEventListener("paste",function(n){var u,o,e,s,t;for(i=n.clipboardData.files,r=-1,u=0;u<i.length;u++)o=i[u],e=o.name.split("."),e[0]=="image"&&(s="file_"+ +new Date,t=prompt("Name the file (without extension of .png):",s),(t==null||t.trim()=="")&&(t=s),e[0]=t,o.customName=e.join("."));h();f();n.preventDefault()}),t.querySelector(".up-clipboard").style.display="block");t.style.display="block"}